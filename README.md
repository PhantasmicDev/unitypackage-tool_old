# UnityPackage Tool

A GitHub action that can pack or unpack Unity [asset packages](https://docs.unity3d.com/Manual/AssetPackages.html) without the Unity editor or Unity project folder.

This action leverages [unity-packer by MirageNet](https://github.com/MirageNet/unity-packer), a fork of [UnityPackager by TwoTenPvP](https://github.com/TwoTenPvP/UnityPackager), to pack or unpack the .unitypackage files.

## Inputs

```yaml
- uses: PhantasmicDev/unitypackage-packer@v1
  with:
    # Either 'pack' or 'unpack'.
    command: ''
    
    # If packing, this is the package that will be generated, must end with '.unitypackage'. 
    # If unpacking this is the '.unitypackage' to extract.
    package: ''
    
    # Json key value pair entries, the key being the file/directory to pack and the value being the target path within the package.
    pack-map: ''
    
    # The location where the '.unitypackage' content will be extracted to when unpacking.
    unpack-directory: ''
```

**Input Requirements For Operation:**

| Inputs | Packing | Unpacking | Description |
| --- | --- | --- | --- |
| `command` | Required | Required | The desired operation. Options are 'pack' and 'unpack'. |
| `package` | Required | Required | If packing, this is the ouput path of the package and must end with '.unitypackage'. If unpacking, this is the '.unitypackage' file to extract. |
| `pack-map` | Required | Not Required | JSON key value pair entries where the key is the file/directory to pack and the value is the target path within the package. |
| `unpack-directory` | Not Required | Required | The location where the '.unitypackage' content will be extracted to when unpacking. |

## Usage
### Packing
Packing a repo that follows [Unity's upm package layout](https://docs.unity3d.com/Manual/cus-layout.html):

```yaml
- uses: PhantasmicDev/unitypackage-packer@v1
  with:
      command: "pack"
      package: "my-cool-package.unitypackage"
      
      # In this example the workspace directory is considered the 'com.organization.package' directory and 
      # for Unity to extract our directory inside the 'Packages' folder, we map our workspace directory to
      # the target path 'Packages/{desired package directory name}'.
      pack-map: |
        {
          "${{ github.workspace }}" : "Packages/com.phantasmicdev.mycoolpackage"
        }
```

## Warning

If packing assets with references to other assets, make sure their respective ['.meta' files](https://docs.unity3d.com/Manual/AssetMetadata.html) (generated by Unity) are present. The packing tool generates missing '.meta' files in order to pack the content which leads to lost references between assets.
